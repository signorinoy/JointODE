% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/JointODE.R
\name{JointODE}
\alias{JointODE}
\title{Fit Joint Model for Longitudinal and Survival Data Using ODEs}
\usage{
JointODE(
  data.long,
  data.surv,
  formula.long,
  formula.surv,
  id = "id",
  time = "time",
  control = list(),
  ...
)
}
\arguments{
\item{data.long}{Data frame containing longitudinal measurements.
Must include multiple observations per subject with columns for
subject ID, measurement times, and response values.}

\item{data.surv}{Data frame containing survival/event data.
Must have exactly one row per subject with event time and status.}

\item{formula.long}{Formula for the longitudinal submodel.
Left side specifies the response; right side includes time and
covariates (e.g., \code{y ~ x1}).}

\item{formula.surv}{Formula for the survival submodel.
Must use \code{Surv(time, status)} on the left side;
right side specifies baseline covariates.}

\item{id}{Character string naming the subject ID variable.
Must exist in both datasets (default: \code{"id"}).}

\item{time}{Character string naming the time variable in
longitudinal data (default: \code{"time"}).}

\item{control}{List of optimization control parameters:
\describe{
\item{\code{method}}{Optimization algorithm (default: "BFGS")}
\item{\code{maxit}}{Maximum iterations (default: 1000)}
\item{\code{tol}}{Convergence tolerance (default: 1e-6)}
\item{\code{verbose}}{Print progress (default: FALSE)}
}}

\item{...}{Additional arguments passed to fitting functions.}
}
\value{
Object of class \code{"JointODE"} containing:
\describe{
\item{\code{coefficients}}{Estimated model parameters including
longitudinal, survival, and association parameters}
\item{\code{logLik}}{Log-likelihood at convergence}
\item{\code{AIC}}{Akaike Information Criterion}
\item{\code{BIC}}{Bayesian Information Criterion}
\item{\code{convergence}}{Optimization convergence details}
\item{\code{fitted}}{Fitted values for both submodels}
\item{\code{residuals}}{Model residuals}
\item{\code{data}}{Original input data}
\item{\code{call}}{Matched function call}
}
}
\description{
Fits a joint model that simultaneously analyzes longitudinal biomarker
trajectories and time-to-event outcomes using ordinary differential
equations (ODEs). This approach captures complex temporal dynamics in
biomarker evolution while quantifying their association with survival
through shared parameters.
}
\details{
The joint ODE model links longitudinal and survival processes through
shared parameters. The longitudinal trajectory is modeled using ODEs
to capture non-linear dynamics, while the survival hazard incorporates
features of the trajectory (level, slope, or cumulative burden).

Model estimation uses maximum likelihood with numerical integration
over random effects via adaptive Gauss-Hermite quadrature.
}
\note{
Input data are automatically validated and processed before fitting.
For large datasets or complex ODE systems, consider adjusting control
parameters to improve convergence.
}
\examples{
\dontrun{
fit <- JointODE(
  data.long = longitudinal_data,
  data.surv = survival_data,
  formula.long = value ~ 1,
  formula.surv = Surv(obstime, status) ~ w1 + w2
)
summary(fit)
}

}
\seealso{
\code{\link{validate}} for data validation,
\code{\link{process}} for data preprocessing
}
\concept{modeling}
