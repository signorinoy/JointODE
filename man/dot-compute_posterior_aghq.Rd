% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils.R
\name{.compute_posterior_aghq}
\alias{.compute_posterior_aghq}
\title{Compute Posterior Moments Using AGHQ}
\usage{
.compute_posterior_aghq(
  ode_solution,
  data,
  b_hat_init,
  measurement_error_sd,
  random_effect_sd,
  k = 7
)
}
\arguments{
\item{ode_solution}{List containing ODE solution with components:
\describe{
\item{cum_hazard}{Cumulative hazard at event time without random effect}
\item{log_hazard}{Log-hazard at event time without random effect}
\item{biomarker}{Biomarker values at observation times without random
effect}
}}

\item{data}{A list containing subject-specific data:
\describe{
\item{time}{Event/censoring time}
\item{status}{Event indicator (0/1)}
\item{covariates}{Baseline covariates for survival model}
\item{longitudinal}{List with times, measurements, covariates}
}}

\item{b_hat_init}{Initial guess for posterior mean \eqn{E[b_i|\mathcal{O}_i]}}

\item{measurement_error_sd}{Measurement error standard deviation}

\item{random_effect_sd}{Random effect standard deviation}

\item{k}{Number of quadrature points (default: 7)}
}
\value{
List containing:
\describe{
\item{b_hat}{Posterior mean \eqn{E[b_i|\mathcal{O}_i]}}
\item{v_hat}{Posterior variance \eqn{Var[b_i|\mathcal{O}_i]}}
\item{exp_b}{\eqn{E[exp(b_i)|\mathcal{O}_i]} for survival component}
}
}
\description{
Computes posterior mean, variance, and other moments of the random effect
using adaptive Gauss-Hermite quadrature via the aghq package.
}
\concept{utilities}
